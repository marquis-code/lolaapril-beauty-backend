import { BookingService } from './booking.service';
import { AppointmentService } from '../../appointment/appointment.service';
import { PaymentService } from '../../payment/payment.service';
import { AvailabilityService } from '../../availability/availability.service';
import { NotificationService } from '../../notification/notification.service';
import { StaffService } from '../../staff/staff.service';
import { BusinessService } from '../../business/business.service';
import { ServiceService } from '../../service/service.service';
import { EventEmitter2 } from '@nestjs/event-emitter';
import { CancellationPolicyService } from '../../cancellation/services/cancellation-policy.service';
import { NoShowManagementService } from '../../cancellation/services/no-show-management.service';
import { SubscriptionService } from '../../subscription/subscription.service';
import { AppointmentResult } from "../types/booking.types";
import { Logger } from 'winston';
import { SourceTrackingService } from '../../commission/services/source-tracking.service';
import { CommissionCalculatorService } from '../../commission/services/commission-calculator.service';
import { CreateBookingWithSourceDto } from '../dto/create-booking-with-source.dto';
interface BookingResult {
    bookingId: string;
    bookingNumber: string;
    estimatedTotal: number;
    expiresAt: Date;
    status: string;
    clientId: string;
    businessId: string;
    booking: any;
    availableSlots?: any[];
    message: string;
    requiresPayment?: boolean;
    requiresDeposit?: boolean;
    depositAmount?: number;
    depositReason?: string;
    remainingAmount?: number;
    commissionInfo?: any;
    clientReliability?: any;
}
interface PaymentResult {
    paymentId: string;
    success: boolean;
    message: string;
    transactionReference: string;
    amount: number;
    method: string;
    gateway: string;
    status: string;
    payment: any;
    appointment: any;
    remainingAmount?: number;
}
export declare class BookingOrchestrator {
    private readonly logger;
    private readonly bookingService;
    private readonly appointmentService;
    private readonly paymentService;
    private readonly availabilityService;
    private readonly notificationService;
    private readonly staffService;
    private readonly businessService;
    private readonly subscriptionService;
    private readonly serviceService;
    private readonly eventEmitter;
    private readonly cancellationPolicyService;
    private readonly noShowManagementService;
    private readonly sourceTrackingService;
    private readonly commissionCalculatorService;
    constructor(logger: Logger, bookingService: BookingService, appointmentService: AppointmentService, paymentService: PaymentService, availabilityService: AvailabilityService, notificationService: NotificationService, staffService: StaffService, businessService: BusinessService, subscriptionService: SubscriptionService, serviceService: ServiceService, eventEmitter: EventEmitter2, cancellationPolicyService: CancellationPolicyService, noShowManagementService: NoShowManagementService, sourceTrackingService: SourceTrackingService, commissionCalculatorService: CommissionCalculatorService);
    private calculateTotalBufferTime;
    private normalizeBookingSource;
    private transformBookingSourceToDto;
    private sendConfirmationNotifications;
    createBookingWithValidation(createBookingDto: CreateBookingWithSourceDto): Promise<BookingResult>;
    private parseDate;
    private formatDateForAvailability;
    private checkAvailabilityForAllServices;
    private checkBusinessWorkingHours;
    private handlePaymentFailure;
    private handleUnavailableSlot;
    private getServicesDetails;
    private calculateTotalDuration;
    private calculateTotalPrice;
    private getServiceDurationInMinutes;
    private addMinutesToTime;
    private getPreferredStaff;
    handlePaymentAndComplete(bookingId: string, transactionReference: string, paymentData: {
        amount: number;
        method: string;
        gateway: string;
        clientId: string;
        businessId: string;
        paymentType?: 'full' | 'deposit' | 'remaining';
    }): Promise<PaymentResult>;
    resetBookingForPaymentRetry(bookingId: string): Promise<void>;
    confirmBookingWithoutStaff(bookingId: string): Promise<AppointmentResult>;
    private sendClientConfirmationOnly;
    confirmBookingAndCreateAppointment(bookingId: string, staffId?: string, staffAssignments?: Array<{
        staffId: string;
        serviceId: string;
        staffName?: string;
    }>): Promise<AppointmentResult>;
    setupDefaultStaffAvailability(businessId: string, staffId: string, createdBy: string): Promise<void>;
    private validateAndReportStaffAvailability;
}
export {};
